{
  "data_model": "Malware",
  "description": "Malware detection and prevention events",
  "constraints": {
    "search": "(`cim_Malware_indexes`) tag=malware tag=attack"
  },
  "datasets": [
    {
      "name": "Malware_Attacks",
      "description": "Malware detection events",
      "tags": ["malware", "attack"],
      "fields": [
        {"name": "_time", "type": "timestamp", "flag": "inherited", "requirement": "required", "description": "The time of the event"},
        {"name": "host", "type": "string", "flag": "inherited", "requirement": "required", "description": "The host that generated the event"},
        {"name": "source", "type": "string", "flag": "inherited", "requirement": "required", "description": "The source of the event"},
        {"name": "sourcetype", "type": "string", "flag": "inherited", "requirement": "required", "description": "The sourcetype of the event"},
        {"name": "action", "type": "string", "flag": "calculated", "requirement": "required", "prescribed_values": ["allowed", "blocked", "deferred", "quarantined", "deleted"], "description": "The action taken on the malware"},
        {"name": "category", "type": "string", "flag": "calculated", "requirement": "optional", "description": "The category of malware"},
        {"name": "dest", "type": "string", "flag": "calculated", "requirement": "required", "description": "The destination system where malware was detected"},
        {"name": "severity", "type": "string", "flag": "calculated", "requirement": "optional", "description": "The severity of the malware threat"},
        {"name": "signature", "type": "string", "flag": "calculated", "requirement": "required", "description": "The name of the malware signature"},
        {"name": "user", "type": "string", "flag": "calculated", "requirement": "recommended", "description": "The user associated with the malware event"},
        {"name": "vendor_product", "type": "string", "flag": "calculated", "requirement": "optional", "description": "The vendor product that detected the malware"},
        {"name": "file_hash", "type": "string", "flag": "extracted", "requirement": "optional", "description": "The hash of the infected file"},
        {"name": "file_name", "type": "string", "flag": "extracted", "requirement": "recommended", "description": "The name of the infected file"},
        {"name": "file_path", "type": "string", "flag": "extracted", "requirement": "recommended", "description": "The full path of the infected file"},
        {"name": "signature_id", "type": "string", "flag": "extracted", "requirement": "optional", "description": "The unique identifier of the malware signature"},
        {"name": "src", "type": "string", "flag": "extracted", "requirement": "optional", "description": "The source of the malware"},
        {"name": "tag", "type": "string", "flag": "extracted", "requirement": "required", "description": "The tags associated with the event"},
        {"name": "url", "type": "string", "flag": "extracted", "requirement": "optional", "description": "The URL associated with the malware"}
      ]
    }
  ],
  "common_sourcetypes": ["symantec:ep:security", "mcafee:epo:threat", "crowdstrike:fdr", "carbonblack", "windows:defender", "sophos:endpoint"]
}
